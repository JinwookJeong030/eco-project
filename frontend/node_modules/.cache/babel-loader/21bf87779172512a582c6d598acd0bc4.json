{"ast":null,"code":"import { createAction, handleActions } from 'redux-actions';\nimport { useSelector } from 'react-redux';\nimport createRequestSaga, { createRequestActionTypes } from '../lib/createRequestSaga';\nimport { takeLatest, call } from 'redux-saga/effects';\nimport * as authAPI from '../lib/api/auth';\nconst TEMP_SET_USER = 'user/TEMP_SET_USER';\nconst HIDING_MENU = 'user/HIDING_MENU';\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] = createRequestActionTypes('user/CHECK');\nconst LOGOUT = 'user/LOGOUT';\nexport const tempSetUser = createAction(TEMP_SET_USER, user => user);\nexport const check = createAction(CHECK, user => user);\nexport const hidingMenu = createAction(HIDING_MENU);\nexport const logout = createAction(LOGOUT);\nconst checkSaga = createRequestSaga(CHECK, authAPI.check);\n\nfunction checkFailureSaga() {\n  try {\n    localStorage.removeItem('user');\n  } catch (e) {\n    console.log('localStorage is not working');\n  }\n}\n\nfunction* logoutSaga() {\n  try {\n    yield call(authAPI.logout);\n    localStorage.removeItem('user');\n    localStorage.removeItem('accessToken');\n    localStorage.removeItem('refreshToken');\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nexport function* userSaga() {\n  yield takeLatest(CHECK, checkSaga);\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\n  yield takeLatest(LOGOUT, logoutSaga);\n}\nconst initialState = {\n  user: null,\n  hidingMenuState: false,\n  checkError: null\n};\nconst user = handleActions({\n  [TEMP_SET_USER]: (state, _ref) => {\n    let {\n      payload: user\n    } = _ref;\n    return { ...state,\n      user\n    };\n  },\n  [CHECK_SUCCESS]: (state, _ref2) => {\n    let {\n      payload: user\n    } = _ref2;\n    return { ...state,\n      user,\n      checkError: null\n    };\n  },\n  [CHECK_FAILURE]: (state, _ref3) => {\n    let {\n      payload: error\n    } = _ref3;\n    return { ...state,\n      user: null,\n      checkError: error\n    };\n  },\n  [LOGOUT]: state => ({ ...state,\n    user: null\n  }),\n  [HIDING_MENU]: state => ({ ...state,\n    hidingMenuState: true\n  })\n}, initialState);\nexport default user;","map":{"version":3,"names":["createAction","handleActions","useSelector","createRequestSaga","createRequestActionTypes","takeLatest","call","authAPI","TEMP_SET_USER","HIDING_MENU","CHECK","CHECK_SUCCESS","CHECK_FAILURE","LOGOUT","tempSetUser","user","check","hidingMenu","logout","checkSaga","checkFailureSaga","localStorage","removeItem","e","console","log","logoutSaga","userSaga","initialState","hidingMenuState","checkError","state","payload","error"],"sources":["D:/GitHub/Capstone/eco-project/frontend/src/modules/user.js"],"sourcesContent":["import { createAction, handleActions } from 'redux-actions';\r\nimport { useSelector } from 'react-redux';\r\nimport createRequestSaga, {\r\n  createRequestActionTypes,\r\n} from '../lib/createRequestSaga';\r\nimport { takeLatest, call } from 'redux-saga/effects';\r\nimport * as authAPI from '../lib/api/auth';\r\n\r\nconst TEMP_SET_USER = 'user/TEMP_SET_USER';\r\nconst HIDING_MENU ='user/HIDING_MENU'; \r\nconst [CHECK, CHECK_SUCCESS, CHECK_FAILURE] =\r\n  createRequestActionTypes('user/CHECK');\r\nconst LOGOUT = 'user/LOGOUT';\r\n\r\nexport const tempSetUser = createAction(TEMP_SET_USER, (user) => user);\r\nexport const check = createAction(CHECK,(user)=>(user));\r\nexport const hidingMenu = createAction(HIDING_MENU);\r\nexport const logout = createAction(LOGOUT);\r\n\r\nconst checkSaga = createRequestSaga(CHECK, authAPI.check);\r\n\r\nfunction checkFailureSaga() {\r\n  try {\r\n    localStorage.removeItem('user');\r\n  } catch (e) {\r\n    console.log('localStorage is not working');\r\n  }\r\n}\r\n\r\nfunction* logoutSaga() {\r\n  try {\r\n    yield call(authAPI.logout);\r\n    localStorage.removeItem('user');\r\n    localStorage.removeItem('accessToken');\r\n    localStorage.removeItem('refreshToken');\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n}\r\n\r\nexport function* userSaga() {\r\n  yield takeLatest(CHECK, checkSaga);\r\n  yield takeLatest(CHECK_FAILURE, checkFailureSaga);\r\n  yield takeLatest(LOGOUT, logoutSaga);\r\n}\r\nconst initialState = {\r\n  user: null,\r\n  hidingMenuState:false,\r\n  checkError: null,\r\n};\r\n\r\nconst user = handleActions(\r\n  {\r\n    [TEMP_SET_USER]: (state, { payload: user }) => ({ ...state, user }),\r\n    [CHECK_SUCCESS]: (state, { payload: user }) => ({\r\n      ...state,\r\n      user,\r\n      checkError: null,\r\n    }),\r\n    [CHECK_FAILURE]: (state, { payload: error }) => ({\r\n      ...state,\r\n      user: null,\r\n      checkError: error,\r\n    }),\r\n    [LOGOUT]: (state) => ({ ...state, user: null }),\r\n    [HIDING_MENU]: (state) =>({...state, hidingMenuState: true})\r\n  },\r\n  initialState,\r\n);\r\nexport default user;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}